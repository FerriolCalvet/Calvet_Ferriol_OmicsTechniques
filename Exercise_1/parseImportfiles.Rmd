---
title: "Exploratory analysis of a GEO dataset"
author: "Ferriol Calvet"
date: "May 15, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction
What this exercise is about

## Summary
The following description was given: *Nebulin is a giant filamentous protein that is coextensive with the actin filaments of the skeletal muscle sarcomere. Nebulin mutations are the main cause of nemaline myopathy (NEM), with typical NEM adult patients having low expression of nebulin, yet the roles of nebulin in adult muscle remain poorly understood. To establish nebulinâ€™s functional roles in adult muscle we performed studies on a novel conditional nebulin KO (Neb cKO) mouse model in which nebulin deletion was driven by the muscle creatine kinase (MCK) promotor. Neb cKO mice are born with high nebulin levels in their skeletal muscle but within weeks after birth nebulin expression rapidly falls to barely detectable levels Surprisingly, a large fraction of the mice survives to adulthood with low nebulin levels (<5% of control), contain nemaline rods, and undergo fiber-type switching towards oxidative types. These microarrays investigate the changes in gene expression when nebulin is deficient.*

## Experimental design
Two skeletal muscle groups were studied: Quadriceps (which is markedly smaller in the Neb cKO mice relative to control) and Soleus (which is not significantly smaller in the Neb cKO relative to control). Six biological replicates for each muscle group were selected; all are age-matched males.

## Citation(s)
This data was published in: 
*Li F, Buck D, De Winter J, Kolb J et al. Nebulin deficiency in adult muscle causes sarcomere defects and muscle-type-dependent changes in trophicity: novel insights in nemaline myopathy. Hum Mol Genet 2015 Sep 15;24(18):5219-33. PMID: 26123491*


## Data description
We have two files:
    Expression matrix, saved as _expres2_
    Targets' information, saved as _targets\_info_ 

```{r}
expres2 <- read.delim("expres2.txt", row.names=1)
targets_info <- read.table("targets.txt", header = T)
# View(expres2)
show(targets_info)
```

The expression matrix contains the different 24 samples in the columns. These samples can be grouped into 4 different groups, with 6 replicates per each group. Note that in the output of the previous chunk you can see these different groups and replicates.
Then for each of the samples we can find 35557 observations, this means that we have information for the expression of 35557 different transcripts.


### Change sample names to informative names
This is optional, we can keep working with the original names
```{r}
# new_names <- paste(targets_info$muscle, targets_info$genotype, targets_info$replicate)

# colnames(expres2) <- new_names
# colnames(expres2)

# head(expres2)
```

## Analysis: Observation and summary

When we make the first boxplot, we can see that the data is very dispersed so that the boxes cannot be appreciated, then if we apply the logarithmic transformation we can see it properly. So from now on we will use the data with the logarithm transformation applied.

```{r}
expres2 <- read.delim("expres2.txt", row.names=1) # this line is to make sure that only one logarithmic transformation is applied

boxplot(expres2)

# we apply log transformation because it is a possible way to correct the data
boxplot(log(expres2))

expres2 <- log(expres2)
```
Comparing the two boxplots, we can see that after the transformation the information of the different groups can be compared easily and with more balanced values.

##### Now start with the real analysis
After applying the logarithm transformation, we can follow the analysis
```{r}
hist(expres2[,1])

row_means_apply <- apply(expres2,1, mean)
hist(row_means_apply)
```

